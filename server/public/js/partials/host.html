<h1>PM2 Process Monitor</h1>
<ul class="nav nav-tabs" ng-controller="HostListController" ng-hide="tabs.length == 1">
	<li ng-repeat="tab in tabs" ng-class="{active: tab.selected}">
		<a ng-click="changeHost(tab.title)" data-toggle="tab">{{tab.title}}</a>
	</li>
</ul>
<section class="system" ng-controller="SystemController">
	<h2>{{system.hostname}}</h2>
	<table class="table">
		<thead>
			<tr>
				<th>Processes</th>
				<th>CPUs</th>
				<th>Load</th>
				<th>Uptime</th>
			</tr>
		</thead>
		<tbody>
			<tr>
				<td>{{system.process_count}}</td>
				<td>{{system.cpu_count}}</td>
				<td><span ng-repeat="load in system.load_avg track by $index">{{load | decimalPlaces:2}}</span></td>
				<td>{{system.uptime | humanise}}</td>
			</tr>
		</tbody>
	</table>
	<figure id="memory">
		<figcaption>Memory ({{system.memory_total | memory}} total)</figcaption>
		<div style="width: {{system.memory_free_percent}}%">{{system.memory_free | memory}} Free</div><div style="width: {{system.memory_used_percent}}%">{{system.memory_used | memory}} Used</div>
	</figure>
</section>
<section class="processes" ng-controller="ProcessListController">
	<h2>Processes</h2>
	<p class="noprocesses" ng-show="processes.length == 0">There are no processes running.</p>
	<article ng-repeat="process in processes">
		<ul class="information">
			<li class="pid">
				<h3>PID</h3>
				<p ng-click="toggleDetails(process.id)">{{process.pid}}</p>
			</li>
			<li class="script">
				<h3>Name</h3>
				<p ng-click="toggleDetails(process.id)">{{process.name}}</p>
			</li>
			<li class="restarts">
				<h3>Restarts</h3>
				<p ng-click="toggleDetails(process.id)">{{process.restarts}}</p>
			</li>
			<li class="uptime">
				<h3>Uptime</h3>
				<p ng-click="toggleDetails(process.id)">{{process.uptime | humanise}}</p>
			</li>
			<li class="status {{process.status}}">
				<h3>Status</h3>
				<p ng-click="toggleDetails(process.id)">
					<i title="Online" ng-show="process.status == 'online'" class="icon-ok-circle {{process.status}}"></i>
					<i title="Stopped" ng-show="process.status == 'stopped'" class="icon-ban-circle {{process.status}}"></i>
					<i title="Error!" ng-show="process.status == 'errored'" class="icon-exclamation-sign {{process.status}}"></i>
					<i title="Launching" ng-show="process.status == 'launching'" class="icon-repeat {{process.status}}"></i>
				</p>
			</li>
			<li class="cpu">
				<h3>CPU</h3>
				<p ng-click="toggleDetails(process.id)">{{process.cpu | decimalPlaces:2}}%</p>
			</li>
			<li class="memory">
				<h3>Memory</h3>
				<p ng-click="toggleDetails(process.id)">{{process.memory | memory}}</p>
			</li>
			<li class="actions">
				<p ng-click="toggleDetails(process.id)">
					<a class="icon-play" title="Start process" ng-hide="process.status == 'online'"  ng-click="start(process.id)"></a>
					<a class="icon-remove" title="Stop process" ng-hide="process.status != 'online'" ng-click="stop(process.id)"></a>
					<a class="icon-refresh" title="Restart process" ng-hide="process.status != 'online'" ng-click="restart(process.id)"></a>
				</p>
			</li>
		</ul>
		<div class="details" ng-show="showDetails[process.id]">
			<h3>Executable</h3>
			<p title="{{process.script}}" class="executable">{{process.script}}</p>
			<h3>Resources</h3>
			<dl class="legend">
				<dt class="cpu">CPU</dt>
				<dd>CPU</dd>
				<dt class="memory">Memory</dt>
				<dd>Memory</dd>
			</dl>
			<figure resourceusage id="resources-{{process.pid}}" data="process.usage" style="width: 100%; height: 300px;"></figure>
		</div>
	</article>
</section>